(function(h){var f=h("html"),g=h("body"),c=h(window);h(document).ready(function(){if(h(".wp-theater-section").length!==0){l()}if(h(".wp-theater-bigscreen").length!==0){e()}});function l(){h(".wp-theater-section").each(function(){var q=this,o=h(this),p,n,m=h(".video-preview",this);external_theater=false;if(!h(".video-preview").length===0){return}if(h(".wp-theater-iframe",this).length!==0){n=h(".wp-theater-bigscreen",this);p=h(".wp-theater-iframe",this)}else{if(o.is("[data-theater-id]")&&h("#"+o.attr("data-theater-id")).length!==0){n=h("#"+o.attr("data-theater-id"));p=h("#"+o.attr("data-theater-id")+" .wp-theater-iframe");external_theater=true}else{return}}m.find("a").click(function(r){r.preventDefault()});m.click(function(s){$video=h(this);if(external_theater){h('.wp-theater-section[data-theater-id="'+o.attr("data-theater-id")+'"]').find(".video-preview.selected").removeClass("selected")}else{o.find(".video-preview.selected").removeClass("selected")}$video.addClass("selected");p.attr("src",$video.attr("data-embed-url"));p.attr("width",parseInt($video.attr("data-embed-width")));p.attr("height",parseInt($video.attr("data-embed-height")));p.trigger("changed");if(!a(n)){var r=n.offset().top;if(g.hasClass("masthead-fixed")){if(h("#masthead").length!==0){r-=parseInt(h("#masthead").height())}else{if(h(".site-header").length!==0){r-=parseInt(h(".site-header:first-child").height())}}}if(h("#wpadminbar").length!==0){r-=parseInt(h("#wpadminbar").height())}h("html, body").animate({scrollTop:Math.round(r-15)+"px"},300)}})})}function e(){h(".wp-theater-bigscreen").each(function(){var t=this,p=h(this),n=p.find(".wp-theater-bigscreen-inner"),r=p.find(".wp-theater-bigscreen-options"),o=p.find("a.fullwindow-toggle"),m=p.find("a.lowerlights-toggle"),q,s=false;if(h(".wp-theater-iframe",this).length!==0){q=h(".wp-theater-iframe",this)}else{return}r.show();i(q);if(o.length!==0){o.click(function(u){if(!p.hasClass("fullwindow")){d();q.attr("style","");p.addClass("fullwindow");g.addClass("fullwindow");j(q,parseInt(n.width()),parseInt(n.height())-parseInt(m.height()),r)}else{p.removeClass("fullwindow");q.attr("style","");r.attr("style","");r.show();i(q);k()}u.preventDefault()})}c.resize(function(){if(p.hasClass("fullwindow")){s=setTimeout(function(){j(q,parseInt(n.width()),parseInt(n.height())-parseInt(m.height()),r)},100)}else{if(typeof p.attr("data-keepratio")!=="undefined"){s=setTimeout(function(){i(q)},100)}else{clearTimeout(s)}}});if(m.length!==0){m.click(function(u){if(p.hasClass("lowerlights")){p.removeClass("lowerlights");h("#wp-theater-lowerlights").fadeOut(1000,function(){h("#wp-theater-lowerlights").hide()})}else{p.addClass("lowerlights");if(h("#wp-theater-lowerlights").length===0){g.prepend('<div id="wp-theater-lowerlights">&nbsp;</div>')}h("#wp-theater-lowerlights").hide(0).fadeIn(1000)}u.preventDefault()})}})}function i(p){var o=parseInt(p.width()),m=parseInt(p.height()),q=parseInt(p.attr("width")),r=parseInt(p.attr("height"));var n=q/r;p.height(o/(q/r))}function j(o,q,p,n){var q=parseInt(q),p=parseInt(p);var m=b(parseInt(o.attr("width"))/parseInt(o.attr("height")),q-40,p-30);n.css("width",Math.round(m.width)+"px");o.css("width",Math.round(m.width)+"px");o.css("height",Math.round(m.height)+"px");n.css("margin-left",Math.round(m.x+20)+"px");o.css("margin-left",Math.round(m.x+20)+"px");o.css("margin-top",Math.round(m.y+15)+"px")}function b(p,o,n){var m={};if(p>=o/n){m.width=parseInt(o);m.height=parseInt(o/p);m.x=0;m.y=parseInt(n-m.height)/2}else{m.width=parseInt(n*p);m.height=parseInt(n);m.x=parseInt(o-m.width)/2;m.y=0}return m}function d(){var o=g.outerWidth(),q=g.outerHeight(),n=[self.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft,self.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop];f.data("scroll-position",n);f.data("previous-overflow",f.css("overflow"));f.css("overflow","hidden");window.scrollTo(n[0],n[1]);var p=g.outerWidth()-o;var m=g.outerHeight()-q;g.css({"margin-right":p,"margin-bottom":m})}function k(){f.css("overflow",f.data("previous-overflow"));var m=f.data("scroll-position");window.scrollTo(m[0],m[1]);g.css({"margin-right":0,"margin-bottom":0})}function a(n){var q=c.scrollTop();var p=q+c.height();var m=n.offset().top;var o=m+n.height();return((o<=p)&&(m>=q))}})(jQuery);